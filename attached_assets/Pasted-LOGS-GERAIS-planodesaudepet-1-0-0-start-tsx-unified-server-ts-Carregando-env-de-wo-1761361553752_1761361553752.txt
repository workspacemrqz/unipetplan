LOGS GERAIS:

> planodesaudepet@1.0.0 start
> tsx unified-server.ts

üîç Carregando .env de: /workspace/.env
üìÑ Status do .env: Carregado com sucesso
üîç Vari√°veis de ambiente carregadas:
   LOGIN: ‚úÖ Configurado
   SENHA: ‚úÖ Configurado
   DATABASE_URL: ‚úÖ Configurado
   NODE_ENV: undefined
‚úÖ Todas as configura√ß√µes obrigat√≥rias est√£o presentes
üîí Valida√ß√£o de seguran√ßa conclu√≠da com sucesso

üöÄ CONFIGURA√á√ÉO AUTOM√ÅTICA APLICADA:
=====================================
üåç Ambiente: production
üîå Porta: 80
üè† Host: 0.0.0.0
üíæ Armazenamento: local
üîë Sess√£o: Configurada
üìû Contato: Configurado via ambiente/banco
=====================================

üîó Conectando ao Supabase Storage: https://tkzzxsbwkgcdmcreducm.supabase.co
‚úÖ [SECURITY] Helmet and CORS configured
üöÄ Inicializando servidor unificado UNIPET + Admin...
üîå Inicializando banco de dados...
üîå Inicializando conex√£o com banco de dados...
‚úÖ Conex√£o com banco de dados estabelecida com sucesso
üìä Pool configurado com 20 conex√µes m√°ximas
‚úÖ Banco de dados inicializado com sucesso
üõ£Ô∏è Registrando rotas compartilhadas (/api/* e /admin/api/*)...
üìÅ [STATIC-FILES] Static file serving disabled - using Supabase Storage
‚úÖ Procedure usage routes registered successfully
‚úÖ Rotas registradas e compartilhadas com admin
üìÅ Admin integrado no cliente principal - usando dist/client para todas as rotas
üìÅ Configurando arquivos est√°ticos...
‚úÖ Arquivos est√°ticos configurados (UNIPET sempre servido)
üõ°Ô∏è Configurando tratamento de erros...

üéâ SERVIDOR UNIFICADO INICIADO COM SUCESSO!
==========================================
üåê URL: http://0.0.0.0:80
üè† Host: 0.0.0.0 (Aceita conex√µes externas)
üåç Ambiente: production
üìÅ Diret√≥rio: /workspace
üîå Banco: Conectado e saud√°vel

üìã SERVI√áOS DISPON√çVEIS:
  ü¶Ñ UNIPET:
    ‚Ä¢ Frontend: / (raiz)
    ‚Ä¢ APIs: /api/*
    ‚Ä¢ Health: /api/health
  üîß ADMIN:
    ‚Ä¢ Frontend: /admin
    ‚Ä¢ APIs: /admin/api/*
    ‚Ä¢ Health: /admin/health

üîí FUNCIONALIDADES:
  ‚Ä¢ Roteamento unificado
  ‚Ä¢ Banco de dados compartilhado
  ‚Ä¢ Sessions e cookies configurados
  ‚Ä¢ Tratamento de erros global
  ‚Ä¢ Arquivos est√°ticos servidos
  ‚Ä¢ Cache otimizado
==========================================

‚úÖ [CORS] Same-origin request allowed
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚úÖ [CORS] Same-origin request allowed
‚úÖ [CORS] Same-origin request allowed
‚úÖ [CORS] Same-origin request allowed
‚úÖ [CORS] Same-origin request allowed
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚ö†Ô∏è [CORS] Blocked origin: https://sites-sistema-unipet.h8upez.easypanel.host
Erro no servidor: Error: Not allowed by CORS
    at origin (/workspace/server/config/security.ts:66:18)
    at /workspace/node_modules/cors/lib/index.js:219:13
    at optionsCallback (/workspace/node_modules/cors/lib/index.js:199:9)
    at corsMiddleware (/workspace/node_modules/cors/lib/index.js:204:7)
    at Layer.handle [as handle_request] (/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/workspace/node_modules/express/lib/router/index.js:328:13)
    at /workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/workspace/node_modules/express/lib/router/index.js:280:10)
    at internalNext (file:///workspace/node_modules/helmet/index.mjs:533:6)
‚úÖ [CORS] Same-origin request allowed
‚úÖ [CORS] Same-origin request allowed
